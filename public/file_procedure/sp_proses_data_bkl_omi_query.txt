--- 1. TBTR_MSTRAN_D
alter table tbtr_mstran_d add mstd_persenppn number;


-- 2.TEMP_BKL_DALAMKOTA
drop table TEMP_BKL_DALAMKOTA2;

CREATE TABLE TEMP_BKL_DALAMKOTA2
(
  RECID      VARCHAR2(100 BYTE),
  GUDANG     VARCHAR2(100 BYTE),
  ID         VARCHAR2(100 BYTE),
  LOKASI     VARCHAR2(100 BYTE),
  RTYPE      VARCHAR2(100 BYTE),
  BUKTI_NO   NUMBER(7),
  BUKTI_TGL  DATE,
  SUPCO      VARCHAR2(100 BYTE),
  CR_TERM    NUMBER(4),
  PRDCD      VARCHAR2(100 BYTE),
  QTY        NUMBER(10),
  BONUS      NUMBER(7),
  PRICE      NUMBER(17),
  GROSS      NUMBER(17),
  PPN        NUMBER(17),
  VNPPN      NUMBER(17),
  FMDFEE     NUMBER(10),
  PPNFEE     NUMBER(8),
  PPNBM      NUMBER(10),
  HRG_BOTOL  NUMBER(9),
  DISC1      NUMBER(9),
  DISC2      NUMBER(9),
  DISC3      NUMBER(9),
  DISC4CR    NUMBER(9),
  DISC4RR    NUMBER(9),
  DISC4JR    NUMBER(9),
  INVNO      VARCHAR2(100 BYTE),
  INV_DATE   DATE,
  PO_NO      NUMBER(9),
  PO_DATE    DATE,
  ISTYPE     VARCHAR2(100 BYTE),
  BKL        VARCHAR2(100 BYTE),
  JAM        VARCHAR2(100 BYTE),
  KETER      VARCHAR2(100 BYTE),
  SESSID     VARCHAR2(200 BYTE),
  NAMAFILE   VARCHAR2(200 BYTE)
);

create table TEMP_BKL_DALAMKOTA_bck as select * from TEMP_BKL_DALAMKOTA;

DROP TABLE TEMP_BKL_DALAMKOTA;

CREATE TABLE TEMP_BKL_DALAMKOTA
(
  RECID      VARCHAR2(100 BYTE),
  GUDANG     VARCHAR2(100 BYTE),
  ID         VARCHAR2(100 BYTE),
  LOKASI     VARCHAR2(100 BYTE),
  RTYPE      VARCHAR2(100 BYTE),
  BUKTI_NO   NUMBER,
  BUKTI_TGL  DATE,
  SUPCO      VARCHAR2(100 BYTE),
  CR_TERM    NUMBER,
  PRDCD      VARCHAR2(100 BYTE),
  QTY        NUMBER,
  BONUS      NUMBER,
  PRICE      NUMBER,
  GROSS      NUMBER,
  PPN        NUMBER,
  VNPPN      NUMBER,
  FMDFEE     NUMBER,
  PPNFEE     NUMBER,
  PPNBM      NUMBER,
  HRG_BOTOL  NUMBER,
  DISC1      NUMBER,
  DISC2      NUMBER,
  DISC3      NUMBER,
  DISC4CR    NUMBER,
  DISC4RR    NUMBER,
  DISC4JR    NUMBER,
  INVNO      VARCHAR2(100 BYTE),
  INV_DATE   DATE,
  PO_NO      NUMBER,
  PO_DATE    DATE,
  ISTYPE     VARCHAR2(100 BYTE),
  BKL        VARCHAR2(100 BYTE),
  JAM        VARCHAR2(100 BYTE),
  KETER      VARCHAR2(100 BYTE),
  NOSPH      NUMBER,
  TGLSPH     DATE,
  SESSID     VARCHAR2(200 BYTE),
  NAMAFILE   VARCHAR2(200 BYTE)
);

insert into TEMP_BKL_DALAMKOTA
select RECID, GUDANG, ID, LOKASI, RTYPE, BUKTI_NO, BUKTI_TGL, SUPCO, CR_TERM, PRDCD, QTY, BONUS, PRICE, GROSS, PPN, null, FMDFEE,
       PPNFEE, PPNBM, HRG_BOTOL, DISC1, DISC2, DISC3, DISC4CR, DISC4RR, DISC4JR, INVNO, INV_DATE, PO_NO, PO_DATE, ISTYPE, BKL, JAM,
       KETER, NOSPH, TGLSPH, SESSID, NAMAFILE from TEMP_BKL_DALAMKOTA_bck;

drop table TEMP_BKL_DALAMKOTA_bck;


-- 3.TEMP_BKL_DALAMKOTA_FULL
create table temp_bkl_dalamkota_full_bck as select * from temp_bkl_dalamkota_full;

DROP TABLE temp_bkl_dalamkota_full;

CREATE TABLE temp_bkl_dalamkota_full
(
  RECID      VARCHAR2(100 BYTE),
  GUDANG     VARCHAR2(100 BYTE),
  ID         VARCHAR2(100 BYTE),
  LOKASI     VARCHAR2(100 BYTE),
  RTYPE      VARCHAR2(100 BYTE),
  BUKTI_NO   NUMBER,
  BUKTI_TGL  DATE,
  SUPCO      VARCHAR2(100 BYTE),
  CR_TERM    NUMBER,
  PRDCD      VARCHAR2(100 BYTE),
  QTY        NUMBER,
  BONUS      NUMBER,
  PRICE      NUMBER,
  GROSS      NUMBER,
  PPN        NUMBER,
  vnppn number,
  FMDFEE     NUMBER,
  PPNFEE     NUMBER,
  PPNBM      NUMBER,
  HRG_BOTOL  NUMBER,
  DISC1      NUMBER,
  DISC2      NUMBER,
  DISC3      NUMBER,
  DISC4CR    NUMBER,
  DISC4RR    NUMBER,
  DISC4JR    NUMBER,
  INVNO      VARCHAR2(100 BYTE),
  INV_DATE   DATE,
  PO_NO      NUMBER,
  PO_DATE    DATE,
  ISTYPE     VARCHAR2(100 BYTE),
  BKL        VARCHAR2(100 BYTE),
  JAM        VARCHAR2(100 BYTE),
  KETER      VARCHAR2(100 BYTE),
  NOSPH      NUMBER,
  TGLSPH     DATE,
  SESSID     VARCHAR2(200 BYTE),
  NAMAFILE   VARCHAR2(200 BYTE),
  CREATE_DT  DATE
);

insert into temp_bkl_dalamkota_full
select RECID, GUDANG, ID, LOKASI, RTYPE, BUKTI_NO, BUKTI_TGL, SUPCO, CR_TERM, PRDCD, QTY, BONUS, PRICE, GROSS, PPN,NULL, FMDFEE, PPNFEE,
       PPNBM, HRG_BOTOL, DISC1, DISC2, DISC3, DISC4CR, DISC4RR, DISC4JR, INVNO, INV_DATE, PO_NO, PO_DATE, ISTYPE, BKL, JAM, KETER, NOSPH,
       TGLSPH, SESSID, NAMAFILE, CREATE_DT from temp_bkl_dalamkota_full_bck;

drop table temp_bkl_dalamkota_full_bck;
